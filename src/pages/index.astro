---
import Layout from "../layouts/Layout.astro";
import Product from "../components/Product.astro";
import ProductSection from "../components/ProductSection.astro";

const apiEndpoint = "https://jgiscxohiqtteuwqyfad.supabase.co/rest/v1/menu";
const apiKey = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImpnaXNjeG9oaXF0dGV1d3F5ZmFkIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MDA1Njg0MjgsImV4cCI6MjAxNjE0NDQyOH0.ioDBej7LRKgrKtxrX7F7ia4lbG2PqH49mwQZHvOb0X4";

const fullMenu = await fetch(apiEndpoint, {
    method: "GET",
    headers: {
        apikey: apiKey,
    },
});
const data = await fullMenu.json();
const sortedData = data.sort((a, b) => a.id - b.id);


---

<Layout title="Falafel Factory">
     <ProductSection sectionText="Vores populÃ¦re rÃ¦tter">
        {
            sortedData.slice(0,3).map ((menuItem) => {
                return <Product ret_billede={menuItem.ret_billede} ret_desc={menuItem.ret_desc} ret_navn={menuItem.ret_navn} ret_pris={menuItem.ret_pris} buttonText="TilfÃ¸j" buttonVariant="primary"/>
            }) 
        }
    </ProductSection>

</Layout>

<script>
</script>

<style>
</style>